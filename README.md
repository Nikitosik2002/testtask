# ТЗ

Написать скрипт на bash для мониторинга процесса test в среде
linux. Скрипт должен отвечать следующим требованиям: 
1. Запускаться при запуске системы (предпочтительно написать юнит systemd в дополнение к скрипту)
2. Отрабатывать каждую минуту
3. Если процесс запущен, то стучаться(по https) на https://test.com/monitoring/test/api 
4. Если процесс был перезапущен, писать в лог /var/log/monitoring.log (если процесс не запущен, то ничего не делать)
5. Если сервер мониторинга не доступен, так же писать в лог.
Решение присылать ссылкой на свой git-репозиторий в Github/Gitlab.

# Bash-мониторинг процесса `test`

Данный проект представляет собой Bash-скрипт и systemd-юниты, предназначенные для мониторинга процесса `test` в среде Linux. Скрипт проверяет, запущен ли процесс, отслеживает его перезапуск и проверяет доступность удалённого HTTPS-сервиса. При недоступности сервера или перезапуске процесса информация записывается в лог `/var/log/monitoring.log`. Запуск скрипта осуществляется автоматически при старте системы и повторяется каждые 60 секунд с помощью `systemd timer`.

## Описание работы

1. Скрипт ищет процесс с именем `test`.  
2. Если процесс не найден — скрипт завершается без вывода (по ТЗ: "если не запущен, ничего не делать").  
3. Если процесс найден впервые — его PID сохраняется в файл `/run/pid.txt`.  
4. При последующих запусках скрипт сравнивает текущий PID с предыдущим:  
   - Если PID совпадает — процесс работает, выполняется запрос по HTTPS.  
   - Если PID изменился — значит процесс был перезапущен, в лог записывается сообщение о перезапуске, и новый PID сохраняется.  
5. Скрипт выполняет HTTPS-запрос к адресу `https://test.com/monitoring/test/api` (переменная `api`).  
   Если сервер недоступен, в лог записывается сообщение о недоступности.  
6. Все записи логируются в файл `/var/log/monitoring.log`.

## Состав проекта

- **testtask.sh** — основной Bash-скрипт, выполняющий проверку процесса и доступность API.  
- **monitoring.service** — systemd unit-файл, запускающий скрипт вручную или по таймеру.  
- **monitoring.timer** — systemd таймер, выполняющий сервис каждую минуту.  
- **monitoring.log** — пример лога с результатами работы скрипта.  
- **pid.txt** — пример state-файла, в котором хранится PID отслеживаемого процесса.
